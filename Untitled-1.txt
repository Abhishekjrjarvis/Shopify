<% let best = 0 %>
                            <% let moderate = 0 %> 
                            <% let good = 0 %>
                            <% let poor = 0 %> 
                            <% let bad = 0 %>   
                        <% for(let r of product.reviews) {%> 
                            <% if(r.rating == 5) {%>   
                                <% best = r.reviewCategory %> 
                            <% } else if(r.rating == 4){ %>
                                <% good = r.reviewCategory %> 
                            <% } else if(r.rating == 3){%>
                                <% moderate = r.reviewCategory %>
                            <% } else if(r.rating == 2){%>
                                <% poor = r.reviewCategory %> 
                            <% } else {%>
                                <% bad = r.reviewCategory %> 
                            <% } %>     
                        <% } %>



// reviewCategory

    <!-- <div class=" row product-row mt-0 mb-5" style="float: right;">
            <div class="col-lg-2">
                <% if(product.reviews.length >= 1) {%>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" id="dropdown-color" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Filter Reviews
                        </a>
                        <div id="dropdown-color" class="dropdown-menu" aria-labelledby="navbarDropdown"> 
                        <a href="/products/<%= product._id %>?reviewCategory=Best" class="dropdown-item Best">
                            Best
                         </a> 
                         <a href="/products/<%= product._id %>?reviewCategory=Good" class="dropdown-item">
                            Good
                         </a>
                         <a href="/products/<%= product._id %>?reviewCategory=Moderate" class="dropdown-item">
                            Moderate
                         </a>
                         <a href="/products/<%= product._id %>?reviewCategory=Poor" class="dropdown-item">
                            Poor
                         </a>
                         <a href="/products/<%= product._id %>?reviewCategory=Bad" class="dropdown-item">
                            Bad
                         </a>                        
                        </div>
                    </li>
                <% } %> 
            </div>
        </div> -->


// css slider.css


/* base */
* {box-sizing: border-box;}

/* slider обертка */
.slider {
  margin: 0;
  border-radius: 15px;
	position: relative;
	height: 100%;
	width: 100%;
	overflow:hidden;
  /* box-shadow: 0 0 20px 0px rgba(255,255,255,0.2); */
}

/*Окно со слайдами*/
.slider-content {
	position: relative;		
	width: 100%;
}

/*Контейнер для слайдов (передвигаем)*/
.slider-content-wrapper {
	display: flex;
	height:300px;
	transition: transform 0.5s ease-in-out;
}

/*Слайд*/
.slider-content__item {
	flex: 1 0 100%;
	width: 100%;
	height: 100%;
  border-radius: 15px;
	background-repeat: no-repeat;
	background-position: center;
	background-size:cover;
	font-size: 40px;
	color: rgba(0,0,0,0.0.7);
	display: flex;
	align-items: center;
	justify-content: center;
}

.image-1 {background-color: rgb(63, 71, 71); background-image: url("https://images.unsplash.com/photo-1563899911-1cd41c199d2a?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=751&q=80");}
.image-2 {background-color: rgb(63, 71, 71); background-image: url("https://images.unsplash.com/photo-1555686913-2e38a187c840?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=1567&q=80");}
.image-3 {background-color: rgb(63, 71, 71); background-image: url("https://images.unsplash.com/photo-1583258292688-d0213dc5a3a8?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=667&q=80");}
.image-4 {background-color: rgb(63, 71, 71); background-image: url("https://images.unsplash.com/photo-1588946356981-d27253455dee?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=748&q=80");}
.image-5 {background-color: rgb(63, 71, 71); background-image: url("https://images.unsplash.com/photo-1498049860654-af1a5c566876?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=750&q=80");}
.image-6 {background-color: rgb(63, 71, 71); background-image: url("https://images.unsplash.com/photo-1483985988355-763728e1935b?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=750&q=80");}


/* Блок с контролами */
.slider-controls {
	padding:20px;
	text-align: center;
}

/* Блок с контролами внутри окна */
.slider-content__controls {
	position:absolute;
	top:0;left:0;
	width: 100%;
	height: 100%;
	z-index:1;
	/*transform: translateY(-50%);*/
	/*padding:0 15px;*/
}

/* Arrows */
.prev-arrow, .next-arrow {
	position:absolute;
	top:50%;
	transform: translateY(-50%);
	cursor: pointer;
	color:rgb(0, 0, 0);
	width: 20px;
	transition: all 0.3s;
}
.prev-arrow {left: 20px;}
.next-arrow {right: 20px;}

.prev-arrow:hover,
.next-arrow:hover {
	cursor: pointer;
	color:rgb(255, 255, 255);
}

/* Dots */
.dots {
	position:absolute;
	display: flex;
	left:50%;
	transform: translateX(-50%);
	bottom:10%;
}

.dot {
	cursor: pointer;
	width: 8px;
	height: 8px;
	margin-right: 4px;
	background-color: rgba(0,0,0, 0.7);
	/*box-shadow: 0 0 5px 0px rgba(0,0,0,0.9);*/
	border-radius: 50%;
	transition:all 0.3s;
}

.dot:last-child {margin-right: 0;}
.dot:hover {background-color: #fff;}
.dot--active {background-color: rgba(255,255,255, 0.7);}

/* Buttons */
button {
 	display: none;
	cursor: pointer;
	margin-right: 8px;
	border:none;
	border-radius: 4px;
	padding:10px;
	background-color: #000000;
	color:#FFF;
	transition: all 0.5s;
}
button:last-child {margin-right: 0;}
button:hover {background-color: #33363a;}
button:focus {outline: none;}

/* Mods */
.disabled {
	background-color: #000000;
	color:#B0A8A8;
	cursor: default;
	pointer-events:none;
}

.d-none {display: none;}
.active {opacity: 1;}
.centered {
	position:relative;
	top:50%;
	left:50%;
	transform:translate(-50%,-50%);	
}

@media only screen and (max-width: 720px){
	button{
		display: inline-block;
	}
}



// slider
    <!-- <div id="slider" class="slider mt-5">
		<div class="slider-content">
			<div class="slider-content-wrapper">
				<div class="slider-content__item image-1"></div>
				<div class="slider-content__item image-2">Toys Store</div>
				<div class="slider-content__item image-3">Grocery Store</div>
				<div class="slider-content__item image-4">4</div>
				<div class="slider-content__item image-5">5</div>
				<div class="slider-content__item image-6">6</div>
			</div>
		</div>
    </div> -->





const slider = (function(){
	const slider = document.getElementById("slider");
	const sliderContent = document.querySelector(".slider-content"); 
	const sliderWrapper = document.querySelector(".slider-content-wrapper");
	const elements = document.querySelectorAll(".slider-content__item"); 
	const sliderContentControls = createHTMLElement("div", "slider-content__controls"); 
	let dotsWrapper = null; 
	let prevButton = null; 
	let nextButton = null;
	let autoButton = null;
	let leftArrow = null; 
	let rightArrow = null;
	let intervalId = null; 

	const itemsInfo = {
		offset: 0, 
		position: {
			current: 0,
			min: 0, 
			max: elements.length - 1 
		},
		intervalSpeed: 2000, 

		update: function(value) {
			this.position.current = value;
			this.offset = -value;
		},
		reset: function() {
			this.position.current = 0;
			this.offset = 0;
		}	
	};

	const controlsInfo = {
		buttonsEnabled: false,
		dotsEnabled: false,
		prevButtonDisabled: true,
		nextButtonDisabled: false
	};

	
	function init(props) {
		
		let {intervalSpeed, position, offset} = itemsInfo;
		if (slider && sliderContent && sliderWrapper && elements) {
			if (props && props.intervalSpeed) {
				intervalSpeed = props.intervalSpeed;
			}
			if (props && props.currentItem) {
				if ( parseInt(props.currentItem) >= position.min && parseInt(props.currentItem) <= position.max ) {
					position.current = props.currentItem;
					offset = - props.currentItem;	
				}
			}
			if (props && props.buttons) {
				controlsInfo.buttonsEnabled = true;
			}
			if (props && props.dots) {
				controlsInfo.dotsEnabled = true;
			}
			
			_updateControlsInfo();
			_createControls(controlsInfo.dotsEnabled, controlsInfo.buttonsEnabled);
			_render();	
		} else {
			console.log("Разметка слайдера задана неверно. Проверьте наличие всех необходимых классов 'slider/slider-content/slider-wrapper/slider-content__item'");
		}
	}

	function _updateControlsInfo() {
		const {current, min, max} = itemsInfo.position;
		controlsInfo.prevButtonDisabled = current > min ? false : true;
		controlsInfo.nextButtonDisabled = current < max ? false : true;
	}

	function _createControls(dots = false, buttons = false) {

		sliderContent.append(sliderContentControls);

		createArrows();
		buttons ? createButtons() : null;
		dots ? createDots() : null;
		
		function createArrows() {
			const dValueLeftArrow = "M31.7 239l136-136c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9L127.9 256l96.4 96.4c9.4 9.4 9.4 24.6 0 33.9L201.7 409c-9.4 9.4-24.6 9.4-33.9 0l-136-136c-9.5-9.4-9.5-24.6-.1-34z";
			const dValueRightArrow = "M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z";
			const leftArrowSVG = createSVG(dValueLeftArrow);
			const rightArrowSVG = createSVG(dValueRightArrow);
			
			leftArrow = createHTMLElement("div", "prev-arrow");
			leftArrow.append(leftArrowSVG);
			leftArrow.addEventListener("click", () => updateItemsInfo(itemsInfo.position.current - 1))
			
			rightArrow = createHTMLElement("div", "next-arrow");
			rightArrow.append(rightArrowSVG);
			rightArrow.addEventListener("click", () => updateItemsInfo(itemsInfo.position.current + 1))

			sliderContentControls.append(leftArrow, rightArrow);
			
			// SVG function
			function createSVG(dValue, color="currentColor") {
				const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
				svg.setAttribute("viewBox", "0 0 256 512");
				const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
				path.setAttribute("fill", color);
				path.setAttribute("d", dValue);
				svg.appendChild(path);	
				return svg;
			}
		}

		// Dots function
		function createDots() {
			dotsWrapper = createHTMLElement("div", "dots");			
			for(let i = 0; i < itemsInfo.position.max + 1; i++) {
				const dot = document.createElement("div");
				dot.className = "dot";
				dot.addEventListener("click", function() {
					updateItemsInfo(i);
				})
				dotsWrapper.append(dot);		
			}
			sliderContentControls.append(dotsWrapper);	
		}
		
		// Buttons function
		function createButtons() {
			const controlsWrapper = createHTMLElement("div", "slider-controls");
			prevButton = createHTMLElement("button", "prev-control", "Prev");
			prevButton.addEventListener("click", () => updateItemsInfo(itemsInfo.position.current - 1))
			
			autoButton = createHTMLElement("button", "auto-control", "Auto");
			autoButton.addEventListener("click", () => {
				intervalId = setInterval(function(){
					if (itemsInfo.position.current < itemsInfo.position.max) {
						itemsInfo.update(itemsInfo.position.current + 1);
					} else {
						itemsInfo.reset();
					}
					_slideItem();
				}, itemsInfo.intervalSpeed)
			})

			nextButton = createHTMLElement("button", "next-control", "Next");
			nextButton.addEventListener("click", () => updateItemsInfo(itemsInfo.position.current + 1))

			controlsWrapper.append(prevButton, autoButton, nextButton);
			slider.append(controlsWrapper);
		}
	}

	// Задать класс для контролов (buttons, arrows)
	function setClass(options) {
		if (options) {
			options.forEach(({element, className, disabled}) => {
				if (element) {
					disabled ? element.classList.add(className) : element.classList.remove(className)	
				} else {
					console.log("Error: function setClass(): element = ", element);
				}
			})
		}
	}

	// Обновить значения слайдера
	function updateItemsInfo(value) {
		itemsInfo.update(value);
		_slideItem(true);	
	}

	// Отобразить элементы
	function _render() {
		const {prevButtonDisabled, nextButtonDisabled} = controlsInfo;
		let controlsArray = [
			{element: leftArrow, className: "d-none", disabled: prevButtonDisabled},
			{element: rightArrow, className: "d-none", disabled: nextButtonDisabled}
		];
		if (controlsInfo.buttonsEnabled) {
			controlsArray = [
				...controlsArray, 
				{element:prevButton, className: "disabled", disabled: prevButtonDisabled},
				{element:nextButton, className: "disabled", disabled: nextButtonDisabled}
			];
		}
		
		// Отображаем/скрываем контроллы
		setClass(controlsArray);

		// Передвигаем слайдер
		sliderWrapper.style.transform = `translateX(${itemsInfo.offset*100}%)`;	
		
		// Задаем активный элемент для точек (dot)
		if (controlsInfo.dotsEnabled) {
			if (document.querySelector(".dot--active")) {
				document.querySelector(".dot--active").classList.remove("dot--active");	
			}
			dotsWrapper.children[itemsInfo.position.current].classList.add("dot--active");
		}
	}

	// Переместить слайд
	function _slideItem(autoMode = false) {
		if (autoMode && intervalId) {
			clearInterval(intervalId);
		}
		_updateControlsInfo();
		_render();
	}

	// Создать HTML разметку для элемента
	function createHTMLElement(tagName="div", className, innerHTML) {
		const element = document.createElement(tagName);
		className ? element.className = className : null;
		innerHTML ? element.innerHTML = innerHTML : null;
		return element;
	}

	// Доступные методы
	return {init};
}())

slider.init({
	// intervalSpeed: 1000,
	currentItem: 0,
	buttons: true,
	dots: true
});






// three-dot 


<!-- 
<link rel="stylesheet" href="/css/three_dot.css">

<div class="container">
    <div class="more">
        <button class="dotted">
            <i class="fas fa-ellipsis-v"></i></button>
        <div class="more-menu">
            <div class="more-menu-caret">
                <div class="more-menu-caret-outer"></div>
                <div class="more-menu-caret-inner"></div>
            </div>
            <ul class="more-menu-items" tabindex="-1" role="menu" aria-labelledby="more-btn" aria-hidden="true">
                <li class="more-menu-item" role="presentation">
                    <button type="button" class="more-menu-btn" role="menuitem">Share</button>
                </li>
            </ul>
        </div>
    </div>
</div>



<script>
var el = document.querySelector('.more');
var btn = el.querySelector('.dotted');
var menu = el.querySelector('.more-menu');
var visible = false;

function showMenu(e) {
    e.preventDefault();
    if (!visible) {
        visible = true;
        el.classList.add('show-more-menu');
        menu.setAttribute('aria-hidden', false);
        document.addEventListener('mousedown', hideMenu, false);
    }
}

function hideMenu(e) {
    if (btn.contains(e.target)) {
        return;
    }
    if (visible) {
        visible = false;
        el.classList.remove('show-more-menu');
        menu.setAttribute('aria-hidden', true);
        document.removeEventListener('mousedown', hideMenu);
    }
}

btn.addEventListener('click', showMenu, false);
</script> -->